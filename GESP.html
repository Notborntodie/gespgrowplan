
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GESP五级链表专题</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #5e35b1;
      --primary-dark: #4527a0;
      --secondary-color: #ff5722;
      --success-color: #4caf50;
      --error-color: #f44336;
      --light-bg: #f8f9fa;
      --card-bg: #ffffff;
      --text-color: #333333;
      --text-light: #777777;
      --border-color: #e0e0e0;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Noto Sans SC', sans-serif;
      background: linear-gradient(135deg, #f9f9f9, #eef2f7);
      margin: 0;
      padding: 0;
      color: var(--text-color);
      min-height: 100vh;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 25px 0;
      background: linear-gradient(120deg, var(--primary-dark), var(--primary-color));
      color: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(69, 39, 160, 0.3);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(to right, #ff9800, #ff5722, #9c27b0);
    }

    h1 {
      font-size: 2.2rem;
      margin-bottom: 10px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .subtitle {
      font-size: 1.1rem;
      font-weight: 400;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
    }

    .instructions {
      max-width: 700px;
      margin: 0 auto 30px auto;
      padding: 25px;
      background: var(--card-bg);
      border-left: 6px solid var(--success-color);
      border-radius: 8px;
      font-size: 0.95em;
      box-shadow: var(--shadow);
      position: relative;
    }

    .instructions::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(to right, transparent, var(--success-color), transparent);
    }

    .instructions ul {
      padding-left: 20px;
      margin: 15px 0;
    }

    .instructions li {
      margin-bottom: 8px;
      position: relative;
      padding-left: 20px;
    }

    .instructions li::before {
      content: "•";
      position: absolute;
      left: 0;
      color: var(--primary-color);
      font-weight: bold;
    }

    .top-section {
      margin-bottom: 30px;
      position: relative;
    }

    .top-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .top-button {
      min-width: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .history-section {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
      position: relative;
      display: none;
      border: 1px solid var(--border-color);
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .history-title {
      font-size: 1.4rem;
      color: var(--primary-dark);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .close-history {
      background: var(--error-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      box-shadow: 0 2px 8px rgba(244, 67, 54, 0.4);
      font-size: 1.1rem;
    }
    
    .close-history:hover {
      background: #d32f2f;
      transform: scale(1.1) rotate(90deg);
      box-shadow: 0 3px 10px rgba(211, 47, 47, 0.5);
    }
    
    .close-popup {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--error-color);
      color: white;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: var(--transition);
      box-shadow: 0 2px 5px rgba(244, 67, 54, 0.4);
    }
    
    .close-popup:hover {
      background: #d32f2f;
      transform: rotate(90deg);
    }

    .history-content {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .history-record {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px dashed var(--border-color);
    }

    .history-record:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .no-history {
      text-align: center;
      padding: 30px 0;
      color: var(--text-light);
      font-size: 1.1rem;
    }

    .no-history i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: #bdbdbd;
    }

    .questions-section {
      margin-bottom: 30px;
    }

    .question {
      background: var(--card-bg);
      padding: 25px;
      margin-bottom: 25px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border-color);
      position: relative;
    }

    .question:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      border-color: var(--primary-color);
    }

    .question::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--primary-color);
      border-radius: 5px 0 0 5px;
    }

    .question-number {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--primary-color);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
    }

    .question p {
      font-weight: bold;
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: #2c3e50;
    }

    .question label {
      display: block;
      padding: 12px 15px;
      margin: 8px 0;
      background: var(--light-bg);
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      border-left: 3px solid #e0e0e0;
    }

    .question label:hover {
      background: #f0f0f0;
      border-left: 3px solid var(--primary-color);
      transform: translateX(5px);
    }

    .question input[type="radio"] {
      margin-right: 12px;
      transform: scale(1.2);
      accent-color: var(--primary-color);
    }

    .question pre {
      background: #f8f8f8;
      color: #333;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      margin-bottom: 20px;
      font-size: 0.95rem;
      line-height: 1.5;
      border: 1px solid #ddd;
      position: relative;
    }

    .question pre::before {
      /*content: "代码示例";*/
      position: absolute;
      top: 0;
      left: 0;
      background: var(--primary-color);
      color: white;
      padding: 3px 8px;
      font-size: 0.8rem;
      border-radius: 0 0 5px 0;
    }

    .divider {
      height: 2px;
      background: linear-gradient(to right, transparent, var(--primary-color), transparent);
      margin: 30px 0;
      border: none;
    }

    .input-section {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
      border: 1px solid var(--border-color);
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 20px;
      max-width: 500px;
      margin: 0 auto;
    }

    .input-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-row label {
      font-weight: 500;
      color: var(--primary-dark);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    input[type="text"] {
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 1rem;
      transition: var(--transition);
      font-family: inherit;
    }

    input[type="text"]:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(69, 39, 160, 0.2);
      outline: none;
    }

    button {
      background: linear-gradient(to right, var(--primary-dark), var(--primary-color));
      color: white;
      border: none;
      border-radius: 8px;
      padding: 14px 25px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: inherit;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(69, 39, 160, 0.4);
    }

    #submit-btn {
      margin-top: 10px;
      padding: 14px;
      font-size: 1.1rem;
      background: linear-gradient(to right, #2e7d32, #4caf50);
    }

    #submit-btn:hover {
      box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
    }

    .result-section {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
      display: none;
      border: 1px solid var(--border-color);
    }

    .result-header {
      font-size: 1.5rem;
      color: var(--primary-dark);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .correct { 
      color: var(--success-color); 
      font-weight: bold;
    }

    .wrong { 
      color: var(--error-color); 
      font-weight: bold;
    }

    .question-result {
      margin-bottom: 15px;
      padding: 15px;
      border-radius: 8px;
      background: var(--light-bg);
      border-left: 3px solid var(--border-color);
    }

    .question-result.correct-answer {
      border-left-color: var(--success-color);
    }
    
    .question-result.wrong-answer {
      border-left-color: var(--error-color);
    }

    #overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }

    #popup {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 16px;
      width: 100%;
      max-width: 450px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      position: relative;
      border: 1px solid var(--border-color);
    }

    #popup h3 {
      margin-bottom: 20px;
      color: var(--primary-dark);
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    #popup input {
      width: 100%;
      padding: 12px 15px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
    }

    .popup-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
    }

    .popup-buttons button {
      min-width: 100px;
    }

    .popup-buttons button:last-child {
      background: linear-gradient(to right, #616161, #9e9e9e);
    }

    .popup-buttons button:last-child:hover {
      box-shadow: 0 5px 15px rgba(158, 158, 158, 0.4);
    }

    #overlay-explain {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    #popup-explain {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 16px;
      width: 100%;
      max-width: 450px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      position: relative;
      border: 1px solid var(--border-color);
    }

    .explain-content {
      max-height: 500px;
      overflow-y: auto;
      padding: 15px;
      text-align: left;
      margin-top: 20px;
      background: var(--light-bg);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .explain-item {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px dashed var(--border-color);
    }

    .explain-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    footer {
      text-align: center;
      padding: 20px 0;
      color: var(--text-light);
      font-size: 0.9rem;
      border-top: 1px solid var(--border-color);
      margin-top: 30px;
    }

    .progress-container {
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin: 20px 0;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
      width: 0;
      transition: width 0.5s ease;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      
      header {
        padding: 20px 0;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .question {
        padding: 20px 15px;
      }
      
      .input-section, .result-section, .history-section {
        padding: 20px;
      }
      
      .top-buttons {
        flex-direction: column;
        gap: 15px;
      }
      
      .top-button {
        width: 100%;
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.5rem;
      }
      
      .instructions {
        padding: 20px 15px;
      }
      
      .popup-buttons {
        flex-direction: column;
      }
      
      .popup-buttons button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-calculator"></i> GESP五级链表专题练习</h1>
      <p class="subtitle">掌握链表相关知识</p>
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
    </header>

    <div class="instructions">
      <p><i class="fas fa-compass"></i> 欢迎参加本次客观题练习！</p>
      <ul>
        <li>如果您此前已经提交过本试卷，可点击上方按钮 <strong>“查询我的答题历史”</strong> 查看之前的作答记录，或点击<strong>“查看题目解析”</strong> 查看整张试卷的题目解析</li>
        <li>无论是否作答过，每位学生都可以重复答题，后续可查看每一次的提交情况</li>
        <li>请如实填写姓名和报名课程的手机号，这将作为记录和查询的依据</li>
      </ul>
      <p><i class="fas fa-pencil-alt"></i> 下面开始答题吧～建议在电脑上作答，部分题目代码块在手机上显示不完全，可左右滑动代码块来翻阅。</p>
    </div>

    <div class="top-section">
      <div class="top-buttons">
        <button class="top-button" onclick="showPopup()"><i class="fas fa-history"></i> 查询我的答题历史</button>
        <button class="top-button" onclick="showExplainPopup()"><i class="fas fa-book-open"></i> 查看题目解析</button>
      </div>
      
      <div class="history-section" id="history-section">
        <div class="history-header">
          <h2 class="history-title"><i class="fas fa-book"></i> 历史答题记录</h2>
          <button class="close-history" onclick="hideHistory()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="history-content" id="history-content">
          <!-- 历史记录内容将在这里动态生成 -->
        </div>
      </div>
      
      <hr class="divider" id="history-divider">
    </div>

<div class="questions-section" id="questions">
  <div class="question">
    <p>1. 链表的存储空间物理上可以连续，也可以不连续。</p>
    <label><input type="radio" name="q1" value="A"> 对</label>
    <label><input type="radio" name="q1" value="B"> 错</label>
  </div>

  <div class="question">
    <p>2. 如果将双向链表的最后一个结点的下一项指针指向第一个结点，第一个结点的前一项指针指向最后一个结点，则该双向链表构成循环链表。</p>
    <label><input type="radio" name="q2" value="A"> 对</label>
    <label><input type="radio" name="q2" value="B"> 错</label>
  </div>

  <div class="question">
    <p>3. 单链表只支持在表头进行插入和删除操作。</p>
    <label><input type="radio" name="q3" value="A"> 对</label>
    <label><input type="radio" name="q3" value="B"> 错</label>
  </div>

  <div class="question">
    <p>4. 下面关于链表和数组的描述，错误的是（ ）。</p>
    <label><input type="radio" name="q4" value="A"> A. 数组大小固定，链表大小可动态调整。</label>
    <label><input type="radio" name="q4" value="B"> B. 数组支持随机访问，链表只能顺序访问。</label>
    <label><input type="radio" name="q4" value="C"> C. 存储相同数目的整数，数组比链表所需的内存多。</label>
    <label><input type="radio" name="q4" value="D"> D. 数组插入和删除元素效率低，链表插入和删除元素效率高。</label>
  </div>

  <div class="question">
    <p>5. 若循环单链表表头，节点的 next 指针指向下一个节点，最后一个节点的 next 指针指向（ ）。</p>
    <label><input type="radio" name="q5" value="A"> A. 当前节点</label>
    <label><input type="radio" name="q5" value="B"> B. nullptr</label>
    <label><input type="radio" name="q5" value="C"> C. 第一个节点</label>
    <label><input type="radio" name="q5" value="D"> D. 上一个节点</label>
  </div>

  <div class="question">
    <p>6. 通过（  ）操作，能完成在双向循环链表结点 p 之后插入结点 s 的功能（其中 next 域为结点的直接后继，prev 域为结点的直接前驱）。</p>
    <label><input type="radio" name="q6" value="A"> A. p->next->prev = s; s->prev = p; p->next = s; s->next = p->next;</label>
    <label><input type="radio" name="q6" value="B"> B. p->next->prev = s; p->next = s; s->prev = p; s->next = p->next;</label>
    <label><input type="radio" name="q6" value="C"> C. p->next = s; s->next = p->next; p->next->prev = s; s->prev = p;</label>
    <label><input type="radio" name="q6" value="D"> D. s->next = p->next; p->next->prev = s; s->prev = p; p->next = s;</label>
  </div>

  <div class="question">
    <p>7. 双向链表中每个结点有两个指针域 prev 和 next，分别指向该结点的前驱及后继结点。设 p 指向链表中的一个结点，它的前驱结点和后继结点均非空。要删除结点 p，以下语句中错误的是（ ）。</p>
    <pre><code>A.
p->next->prev = p->next;
p->prev->next = p->prev;
delete p;</code></pre>
    <pre><code>B.
p->prev->next = p->next;
p->next->prev = p->prev;
delete p;</code></pre>
    <pre><code>C.
p->next->prev = p->prev;
p->next->prev->next = p->next;
delete p;</code></pre>
    <pre><code>D.
p->prev->next = p->next;
p->prev->next->prev = p->prev;
delete p;</code></pre>
    <label><input type="radio" name="q7" value="A"> A</label>
    <label><input type="radio" name="q7" value="B"> B</label>
    <label><input type="radio" name="q7" value="C"> C</label>
    <label><input type="radio" name="q7" value="D"> D</label>
  </div>

  <div class="question">
    <p>8. 下述查询函数在双向链表中查找歌曲，其时间复杂度为（ ）。</p>
    <pre><code>struct dl_node {
    string song;
    dl_node* next;
    dl_node* prev;
};

dl_node* search(dl_node* head, string my_song) {
    dl_node* temp = head;
    while (temp != nullptr) {
        if (temp->song == my_song)
            return temp;
        temp = temp->next;
    }
    return nullptr;
}</code></pre>
    <label><input type="radio" name="q8" value="A"> A. O(1)</label>
    <label><input type="radio" name="q8" value="B"> B. O(n)</label>
    <label><input type="radio" name="q8" value="C"> C. O(log n)</label>
    <label><input type="radio" name="q8" value="D"> D. O(n²)</label>
  </div>

  <div class="question">
    <p>9. 将一首新歌插入为双向链表的第一个节点，横线应填入的代码为（ ）。</p>
    <pre><code>void insert(dl_node *head, string my_song) {
    p = new dl_node;
    p->song = my_song;
    p->prev = nullptr;
    p->next = head;

    if (head != nullptr) {
        _____________;  // 在此处填入代码
    }
    head = p;
}</code></pre>
    <label><input type="radio" name="q9" value="A"> A. head->next->prev = p;</label>
    <label><input type="radio" name="q9" value="B"> B. head->next = p;</label>
    <label><input type="radio" name="q9" value="C"> C. head->prev = p;</label>
    <label><input type="radio" name="q9" value="D"> D. 触发异常，不能对空指针进行操作。</label>
  </div>

  <div class="question">
    <p>10. 下列代码使用虚拟头节点删除链表中值为 val 的元素，横线上应填最佳代码是（ ）。</p>
    <pre><code>struct LinkedNode {
    int val;
    LinkedNode* next;
    LinkedNode(int val): val(val), next(nullptr) {}
};

void removeElements(LinkedNode* head, int val) {
    if (head == nullptr) return;

    LinkedNode* cur;
    LinkedNode* dummyHead = new LinkedNode(0);
    _______________________ // 在这里填空

    while (cur->next != nullptr) {
        if (cur->next->val == val) {
            LinkedNode* tmp = cur->next;
            cur->next = cur->next->next;
            delete tmp;
            tmp = nullptr;
        } else {
            cur = cur->next;
        }
    }

    head = dummyHead->next;
    delete dummyHead;
    dummyHead = nullptr;
}</code></pre>
    <label><input type="radio" name="q10" value="A"> A. dummyHead->next = head; cur = dummyHead;</label>
    <label><input type="radio" name="q10" value="B"> B. dummyHead->next = head->next; cur = dummyHead;</label>
    <label><input type="radio" name="q10" value="C"> C. dummyHead->next = head; cur = dummyHead->next;</label>
    <label><input type="radio" name="q10" value="D"> D. dummyHead->next = head->next; cur = dummyHead->next;</label>
  </div>

  <div class="question">
    <p>11. 下面代码实现了一个空的双向循环链表，横线上应填入的最佳代码是（ ）。</p>
    <pre><code>template &lt;typename T&gt;
struct ListNode {
    T data;
    ListNode* prev;
    ListNode* next;
    explicit ListNode(const T&amp; val = T()) : data(val), prev(nullptr), next(nullptr) {}
};

struct LinkedList {
    ListNode&lt;T&gt;* head;
    ListNode&lt;T&gt;* tail;
};

void InitLinkedList(LinkedList* list) {
    list->head = new ListNode&lt;T&gt;;
    list->tail = new ListNode&lt;T&gt;;
    _____________ // 在此处填入代码
}</code></pre>
    <label><input type="radio" name="q11" value="A"> A. list->head->prev = list->head; list->tail->prev = list->head;</label>
    <label><input type="radio" name="q11" value="B"> B. list->head->next = list->tail; list->tail->prev = list->head;</label>
    <label><input type="radio" name="q11" value="C"> C. list->head->next = list->tail; list->tail->next = list->head;</label>
    <label><input type="radio" name="q11" value="D"> D. list->head->next = list->tail; list->tail->next = nullptr;</label>
  </div>
</div>



    <div class="input-section">
      <div class="input-group">
        <div class="input-row">
          <label for="name"><i class="fas fa-user"></i> 姓名</label>
          <input type="text" id="name" placeholder="请输入您的姓名">
        </div>
        <div class="input-row">
          <label for="phone"><i class="fas fa-phone"></i> 手机号</label>
          <input type="text" id="phone" placeholder="请输入您报名课程的手机号">
        </div>
        <button id="submit-btn" onclick="submitAnswers()"><i class="fas fa-paper-plane"></i> 提交答题</button>
      </div>
    </div>

    <div class="result-section" id="result">
      <!-- 答题结果将在这里动态生成 -->
    </div>

    <div id="overlay">
      <div id="popup">
        <button class="close-popup" onclick="hidePopup()">
          <i class="fas fa-times"></i>
        </button>
        <h3><i class="fas fa-history"></i> 查询历史记录</h3>
        <input type="text" id="history-name" placeholder="请输入姓名">
        <input type="text" id="history-phone" placeholder="请输入手机号">
        <div class="popup-buttons">
          <button onclick="doQueryHistory()"><i class="fas fa-search"></i> 查询</button>
          <button onclick="hidePopup()"><i class="fas fa-times"></i> 取消</button>
        </div>
      </div>
    </div>
    
    <div id="overlay-explain">
      <div id="popup-explain">
        <button class="close-popup" onclick="hideExplainPopup()"><i class="fas fa-times"></i></button>
        <h3><i class="fas fa-book-open"></i> 查看解析</h3>
        <input type="text" id="explain-name" placeholder="请输入姓名">
        <input type="text" id="explain-phone" placeholder="请输入手机号">
        <div class="popup-buttons">
          <button onclick="submitExplainQuery()"><i class="fas fa-search"></i> 查看</button>
          <button onclick="hideExplainPopup()"><i class="fas fa-times"></i> 取消</button>
        </div>
        <div class="explain-content" id="explain-content" style="display:none;">
          <!-- 解析内容将在这里动态生成 -->
        </div>
      </div>
    </div>

    <footer>
      <p>© 2025 王添翼老师 | GESP练习系统</p>
    </footer>
  </div>

  <script>
    const BASE_URL = "http://wangtianyi.vip:5002";
    const EXAM_ID = 5003;
    
    // 题目解析
    const solutions = [
  "1. 【解析】对。链表的节点在内存中可以连续，也可以不连续。就像用绳子串珠子，每个珠子（节点）可能分散在不同地方，只要用指针串起来，顺序就能保持。数组是连续存储，而链表用指针连接，不要求连续，这也是链表的一大灵活性。",
  
  "2. 【解析】对。如果双向链表的最后一个结点的 next 指向第一个结点，第一个结点的 prev 指向最后一个结点，这样首尾连在一起，形成一个闭合的环，叫做循环链表。就像小朋友围成一个圈，一个拉着下一个的手，最后一个也拉着第一个的手。",
  
  "3. 【解析】错。虽然单链表在表头插入删除很快，但只要我们知道前一个节点，也能在中间或尾部插入删除。单链表并不局限于只能操作表头，只是表头操作最简单。",
  
  "4. 【解析】C 错误。A 正确，数组大小固定；B 正确，数组可以快速定位第 k 个元素，而链表只能一个一个找；C 错误，链表为了连接节点要额外保存指针，比数组更占空间；D 正确，链表插入删除只改指针更高效。所以 C 错在于说反了，链表其实更占内存。",
  
  "5. 【解析】C 正确。循环单链表的特点是最后一个节点的 next 指向第一个节点。这样可以从任何一个节点出发不断走下去，不会遇到 nullptr。A 指向自己不对；B 指向空表示非循环；D 指向前一个也不是循环单链表的结构。",
  
  "6. 【解析】D 正确。要在 p 节点后插入 s，正确顺序是：让 s 指向 p 的后一个（s->next = p->next），让 p->next 的 prev 指回 s（p->next->prev = s），再让 s->prev = p，p->next = s。这四步形成新的双向连接，把 s 嵌入在 p 和原来的 p->next 之间。",
  
  "7. 【解析】A 错误。删除节点 p 要让前一个节点的 next 指向 p 的 next，同时 p 的 next 的 prev 指向 p 的前一个。A 中 p->next->prev = p->next 是错误的，它让 p 后面的 prev 指向自己，断开了原链。B 是正确的标准写法，能正确连接前后节点并删除 p。",
  
  "8. 【解析】B 正确。函数 search 从链表头一个一个往下找，最坏情况下要查完整个链表，所以时间复杂度是 O(n)。链表不能像数组那样一下子定位到目标，只能顺序查找。O(1) 是常数时间，适合用在能直接找到目标的位置，比如哈希表或数组索引。",
  
  "9. 【解析】C 正确。我们在链表头插入一个新节点 p，它的 next 指向旧 head，prev 设为 nullptr。旧 head 的 prev 应该改为 p，也就是 head->prev = p。这步不能省略，否则链表前后方向就断开了。",
  
  "10. 【解析】A 正确。为了方便处理删除操作，尤其是可能删除头节点的情况，我们先创建一个虚拟头 dummyHead，它的 next 指向真正的 head。然后从 dummyHead 开始遍历整个链表，遇到值为 val 的就删除。这种方法能统一处理各种情况，写法简单且鲁棒性强。",
  
  "11. 【解析】B 正确。我们要创建一个空的双向循环链表结构，有头尾哨兵节点。初始状态下：head->next = tail 表示链表开始；tail->prev = head 表示链表结束。后续插入元素时就插在这两者之间。这样设计方便处理边界情况，不用频繁判断头尾。"
];
    // DOM元素引用
    const historySection = document.getElementById('history-section');
    const historyContent = document.getElementById('history-content');
    const historyDivider = document.getElementById('history-divider');
    const resultSection = document.getElementById('result');
    const explainContent = document.getElementById('explain-content');
    const progressBar = document.getElementById('progress-bar');
    
    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', () => {
      // 初始隐藏历史记录区域和分割线
      historySection.style.display = 'none';
      historyDivider.style.display = 'none';
      
      // 初始化进度条
      updateProgressBar();
      
      // 添加答题事件监听
      document.querySelectorAll('.question input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', updateProgressBar);
      });
    });

    // 更新进度条
    function updateProgressBar() {
      const answeredCount = document.querySelectorAll('.question input[type="radio"]:checked').length;
      const totalQuestions = document.querySelectorAll('.question').length;
      const percentage = (answeredCount / totalQuestions) * 100;
      progressBar.style.width = `${percentage}%`;
    }

    // 提交答题
    async function submitAnswers() {
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;

      // 表单验证
      if (!name || !phone) {
        alert("请填写姓名和手机号");
        return;
      }
      
      // 检查是否所有题目都已作答
      const unanswered = [];
      for (let i = 1; i <= 11; i++) {
        if (!document.querySelector(`input[name="q${i}"]:checked`)) {
          unanswered.push(i);
        }
      }
      
      if (unanswered.length > 0) {
        alert(`请完成第 ${unanswered.join(', ')} 题`);
        return;
      }

      // 收集答案
      const answers = {};
      for (let i = 1; i <= 11; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        answers[i] = selected ? selected.value : "";
      }

      // 准备提交数据
      const data = {
        name: name,
        phone: phone,
        exam_id: EXAM_ID,
        answers: answers
      };

      try {
        // 调用后端API
        const response = await fetch(`${BASE_URL}/submit`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        if (!response.ok) {
          throw new Error(`提交失败: ${response.status}`);
        }

        const resultData = await response.json();
        displayResult(resultData);
        
        // 滚动到结果区域
        resultSection.scrollIntoView({ behavior: 'smooth' });
      } catch (error) {
        console.error('提交错误:', error);
        alert('提交失败，请稍后再试');
      }
    }

    // 显示答题结果
    function displayResult(data) {
      resultSection.style.display = 'block';
      resultSection.innerHTML = `
        <div class="result-header">
          <i class="fas fa-check-circle"></i>
          <h2>提交成功，第 ${data.attempt_number} 次作答</h2>
        </div>
        <div class="score-display">
          <p style="font-size: 1.3rem; margin-bottom: 20px;">得分：<span style="font-weight:700;font-size:1.8rem;color:#4527a0">${data.score}</span> / 11</p>
        </div>
      `;
      
      Object.entries(data.result).forEach(([q, r]) => {
        const isCorrect = r.correct;
        resultSection.innerHTML += `
          <div class="question-result ${isCorrect ? 'correct-answer' : 'wrong-answer'}">
            <p>第${q}题：你的答案：${r.your_answer}， 
              ${isCorrect ? 
                `<span class='correct'><i class="fas fa-check"></i> 正确</span>` : 
                `<span class='wrong'><i class="fas fa-times"></i> 错误，正确答案：${r.correct_answer}</span>`}
            </p>
            <p style="margin-top: 8px; color: #555;"><i class="fas fa-lightbulb"></i> ${solutions[q - 1]}</p>
          </div>
        `;
      });
    }

    // 显示历史查询弹窗
    function showPopup() {
      document.getElementById('overlay').style.display = 'flex';
    }

    // 隐藏历史查询弹窗
    function hidePopup() {
      document.getElementById('overlay').style.display = 'none';
    }

    // 显示解析弹窗
    function showExplainPopup() {
      document.getElementById('overlay-explain').style.display = 'flex';
      document.getElementById('explain-content').style.display = 'none';
    }

    // 隐藏解析弹窗
    function hideExplainPopup() {
      document.getElementById('overlay-explain').style.display = 'none';
    }

    // 显示历史记录区域
    function showHistory() {
      historySection.style.display = 'block';
      historyDivider.style.display = 'block';
    }

    // 隐藏历史记录区域
    function hideHistory() {
      historySection.style.display = 'none';
      historyDivider.style.display = 'none';
    }

    // 查询历史记录
    async function doQueryHistory() {
      const name = document.getElementById('history-name').value;
      const phone = document.getElementById('history-phone').value;

      if (!name || !phone) {
        alert("请填写姓名和手机号");
        return;
      }

      try {
        // 准备查询数据
        const data = {
          name: name,
          phone: phone,
          exam_id: EXAM_ID
        };

        // 调用后端API
        const response = await fetch(`${BASE_URL}/history`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        if (!response.ok) {
          throw new Error(`查询失败: ${response.status}`);
        }

        const historyData = await response.json();
        
        // 显示历史记录区域
        showHistory();
        
        if (historyData.length === 0) {
          historyContent.innerHTML = `
            <div class="no-history">
              <i class="fas fa-file-excel"></i>
              <p>没有找到您的答题历史记录</p>
              <p style="margin-top:10px;">请完成一次答题后再来查询</p>
            </div>
          `;
        } else {
          historyContent.innerHTML = '';
          historyData.forEach(record => {
            const recordElement = document.createElement('div');
            recordElement.className = 'history-record';
            recordElement.innerHTML = `
              <p style="font-weight:700;margin-bottom:10px;color:#4527a0">
                第 ${record.attempt_number} 次作答，得分 <span style="color:#4caf50">${record.score}</span>
                <span style="float:right;font-weight:500;color:#777;font-size:0.9rem">${record.submit_time}</span>
              </p>
            `;
            
            record.answers.forEach(ans => {
              recordElement.innerHTML += `
                <p style="margin:8px 0;padding-left:10px;">
                  题${ans.question_number}：你的答案：${ans.your_answer}，
                  ${ans.correct ? 
                    `<span class='correct'><i class="fas fa-check"></i> 正确</span>` : 
                    `<span class='wrong'><i class="fas fa-times"></i> 错误，正确答案：${ans.correct_answer}</span>`}
                </p>
              `;
            });
            
            historyContent.appendChild(recordElement);
          });
        }
      } catch (error) {
        console.error('查询错误:', error);
        alert('查询失败，请稍后再试');
      }
      
      hidePopup();
    }

    // 提交解析查询
    async function submitExplainQuery() {
      const name = document.getElementById('explain-name').value;
      const phone = document.getElementById('explain-phone').value;

      if (!name || !phone) {
        alert("请填写姓名和手机号");
        return;
      }

      try {
        // 准备检查数据
        const data = {
          name: name,
          phone: phone,
          exam_id: EXAM_ID
        };

        // 调用后端检查API
        const response = await fetch(`${BASE_URL}/has_submitted`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        if (!response.ok) {
          throw new Error(`检查提交状态失败: ${response.status}`);
        }

        const result = await response.json();
        
        if (!result.has_submitted) {
          alert("未检测到该学生提交记录，无法查看解析。");
          return;
        }

        // 显示解析内容
        document.getElementById('explain-content').style.display = 'block';
        explainContent.innerHTML = '<h4 style="margin-bottom:15px;color:#4527a0;"><i class="fas fa-lightbulb"></i> 试题解析</h4>';
        
        solutions.forEach((sol, idx) => {
          const div = document.createElement("div");
          div.className = "explain-item";
          div.innerHTML = `<p style="margin-bottom: 8px;font-weight:500;">第 ${idx + 1} 题解析：</p><p style="color:#555;">${sol}</p>`;
          explainContent.appendChild(div);
        });

        // 滚动到解析内容
        explainContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } catch (err) {
        console.error("解析查询失败：", err);
        alert("网络错误，请稍后重试");
      }
    }
  </script>
</body>
</html>
