# æ•™å¸ˆæƒé™å’Œæ¥å£è¯´æ˜æ–‡æ¡£

## ğŸ“‹ æ•™å¸ˆè§’è‰²æ¦‚è¿°

æ•™å¸ˆè§’è‰²ï¼ˆ`teacher`ï¼‰æ˜¯ç³»ç»Ÿä¸­çš„ç‰¹æ®Šç”¨æˆ·ç±»å‹ï¼Œæ‹¥æœ‰ç®¡ç†å­¦ç”Ÿç”¨æˆ·å’ŒæŸ¥çœ‹å­¦ç”Ÿå­¦ä¹ æ•°æ®çš„æƒé™ï¼Œä½†**æ²¡æœ‰**å¯¹é¢˜ç›®ã€è€ƒè¯•ç­‰æ ¸å¿ƒå†…å®¹çš„ç®¡ç†æƒé™ã€‚

## ğŸ” æ•™å¸ˆæƒé™è¯¦æƒ…

### å­¦ç”Ÿç®¡ç†æƒé™
- âœ… **åˆ›å»ºå­¦ç”Ÿ** (`student.create`) - å¯ä»¥åˆ›å»ºæ–°çš„å­¦ç”Ÿç”¨æˆ·
- âœ… **æŸ¥çœ‹å­¦ç”Ÿ** (`student.read`) - å¯ä»¥æŸ¥çœ‹å­¦ç”Ÿç”¨æˆ·ä¿¡æ¯
- âœ… **æ›´æ–°å­¦ç”Ÿ** (`student.update`) - å¯ä»¥ä¿®æ”¹å­¦ç”Ÿç”¨æˆ·ä¿¡æ¯
- âœ… **åˆ é™¤å­¦ç”Ÿ** (`student.delete`) - å¯ä»¥åˆ é™¤å­¦ç”Ÿç”¨æˆ·
- âœ… **ç»‘å®šå­¦ç”Ÿ** (`student.bind`) - å¯ä»¥å°†å­¦ç”Ÿç»‘å®šåˆ°è‡ªå·±çš„ç­çº§

### å­¦ç”Ÿå­¦ä¹ æ•°æ®æŸ¥çœ‹æƒé™
- âœ… **æŸ¥çœ‹å­¦ç”Ÿç­”é¢˜** (`student.submission.read`) - å¯ä»¥æŸ¥çœ‹å­¦ç”Ÿçš„ç­”é¢˜è®°å½•
- âœ… **æŸ¥çœ‹å­¦ç”Ÿé”™é¢˜** (`student.wrong.read`) - å¯ä»¥æŸ¥çœ‹å­¦ç”Ÿçš„é”™é¢˜æƒ…å†µ
- âœ… **æŸ¥çœ‹å­¦ç”Ÿç»Ÿè®¡** (`student.stats.read`) - å¯ä»¥æŸ¥çœ‹å­¦ç”Ÿçš„å­¦ä¹ ç»Ÿè®¡

### å…¶ä»–æƒé™
- âœ… **æŸ¥çœ‹ç”¨æˆ·** (`user.read`) - å¯ä»¥æŸ¥çœ‹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
- âœ… **é‡ç½®ç”¨æˆ·å¯†ç ** (`user.reset_password`) - å¯ä»¥é‡ç½®å­¦ç”Ÿå¯†ç 
- âœ… **æŸ¥çœ‹é¢˜ç›®** (`question.read`) - å¯ä»¥æŸ¥çœ‹é¢˜ç›®å†…å®¹ï¼ˆåªè¯»ï¼‰
- âœ… **æŸ¥çœ‹è€ƒè¯•** (`exam.read`) - å¯ä»¥æŸ¥çœ‹è€ƒè¯•ä¿¡æ¯ï¼ˆåªè¯»ï¼‰
- âœ… **æäº¤ç­”æ¡ˆ** (`submission.create`) - å¯ä»¥æäº¤è‡ªå·±çš„ç­”æ¡ˆ
- âœ… **æŸ¥çœ‹ç­”é¢˜è®°å½•** (`submission.read`) - å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ç­”é¢˜è®°å½•

### æ•™å¸ˆä¸èƒ½åšçš„äº‹æƒ…
- âŒ åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤é¢˜ç›®
- âŒ åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤è€ƒè¯•
- âŒ ç®¡ç†ç³»ç»Ÿè®¾ç½®
- âŒ ç®¡ç†å…¶ä»–æ•™å¸ˆæˆ–ç®¡ç†å‘˜
- âŒ æŸ¥çœ‹å…¶ä»–æ•™å¸ˆçš„å­¦ç”Ÿæ•°æ®

## ğŸš€ æ•™å¸ˆç›¸å…³APIæ¥å£

### 1. æ•™å¸ˆç»‘å®šå­¦ç”Ÿ

**æ¥å£åœ°å€ï¼š** `POST /api/teacher/:teacherId/students`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "student_ids": [1, 2, 3]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "å­¦ç”Ÿç»‘å®šæˆåŠŸ",
  "data": {
    "bound_count": 3,
    "bound_students": [
      {
        "id": 1,
        "username": "student001",
        "real_name": "å­¦ç”Ÿ001"
      }
    ]
  }
}
```

### 2. è·å–æ•™å¸ˆçš„å­¦ç”Ÿåˆ—è¡¨

**æ¥å£åœ°å€ï¼š** `GET /api/teacher/:teacherId/students`

**æŸ¥è¯¢å‚æ•°ï¼š**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `limit` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `search` (å¯é€‰): æœç´¢å…³é”®è¯ï¼ˆç”¨æˆ·åæˆ–çœŸå®å§“åï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "students": [
      {
        "id": 1,
        "username": "student001",
        "real_name": "å­¦ç”Ÿ001",
        "email": "student001@example.com",
        "created_at": "2024-01-01T00:00:00.000Z",
        "total_submissions": 15,
        "correct_submissions": 12,
        "accuracy_rate": 80.0
      }
    ],
    "pagination": {
      "current_page": 1,
      "total_pages": 1,
      "total_count": 1,
      "limit": 10
    }
  }
}
```

### 3. è§£ç»‘å­¦ç”Ÿ

**æ¥å£åœ°å€ï¼š** `DELETE /api/teacher/:teacherId/students/:studentId`

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "å­¦ç”Ÿè§£ç»‘æˆåŠŸ"
}
```

### 4. æŸ¥çœ‹å­¦ç”Ÿç­”é¢˜è®°å½•

**æ¥å£åœ°å€ï¼š** `GET /api/teacher/:teacherId/students/:studentId/submissions`

**æŸ¥è¯¢å‚æ•°ï¼š**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `limit` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `exam_id` (å¯é€‰): è€ƒè¯•IDç­›é€‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "submissions": [
      {
        "id": 1,
        "exam_id": 1,
        "exam_title": "GESPä¸€çº§æ¨¡æ‹Ÿè€ƒè¯•",
        "question_id": 1,
        "question_title": "é¢˜ç›®1",
        "user_answer": "A",
        "correct_answer": "A",
        "is_correct": true,
        "submitted_at": "2024-01-01T10:00:00.000Z"
      }
    ],
    "pagination": {
      "current_page": 1,
      "total_pages": 1,
      "total_count": 1,
      "limit": 10
    }
  }
}
```

### 5. æŸ¥çœ‹å­¦ç”Ÿé”™é¢˜

**æ¥å£åœ°å€ï¼š** `GET /api/teacher/:teacherId/students/:studentId/wrong-questions`

**æŸ¥è¯¢å‚æ•°ï¼š**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `limit` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `exam_id` (å¯é€‰): è€ƒè¯•IDç­›é€‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "wrong_questions": [
      {
        "id": 1,
        "exam_id": 1,
        "exam_title": "GESPä¸€çº§æ¨¡æ‹Ÿè€ƒè¯•",
        "question_id": 2,
        "question_title": "é¢˜ç›®2",
        "user_answer": "B",
        "correct_answer": "A",
        "submitted_at": "2024-01-01T10:05:00.000Z"
      }
    ],
    "pagination": {
      "current_page": 1,
      "total_pages": 1,
      "total_count": 1,
      "limit": 10
    }
  }
}
```

### 6. æŸ¥çœ‹å­¦ç”Ÿå­¦ä¹ ç»Ÿè®¡

**æ¥å£åœ°å€ï¼š** `GET /api/teacher/:teacherId/students/:studentId/stats`

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "student_info": {
      "id": 1,
      "username": "student001",
      "real_name": "å­¦ç”Ÿ001",
      "email": "student001@example.com"
    },
    "statistics": {
      "total_submissions": 50,
      "correct_submissions": 40,
      "accuracy_rate": 80.0,
      "total_exams_taken": 5,
      "average_score": 85.5,
      "study_days": 15,
      "last_submission_date": "2024-01-15T14:30:00.000Z"
    },
    "recent_activity": [
      {
        "date": "2024-01-15",
        "submissions_count": 3,
        "accuracy_rate": 75.0
      }
    ]
  }
}
```

## ğŸ‘¥ æ•™å¸ˆåˆ›å»ºå­¦ç”Ÿç”¨æˆ·

æ•™å¸ˆå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºå­¦ç”Ÿç”¨æˆ·ï¼š

### ä½¿ç”¨æ³¨å†Œæ¥å£åˆ›å»ºå­¦ç”Ÿ

**æ¥å£åœ°å€ï¼š** `POST /api/register`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "username": "student001",
  "password": "student123",
  "email": "student001@example.com",
  "real_name": "å­¦ç”Ÿ001",
  "role_id": 2
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
  "data": {
    "user_id": 5,
    "username": "student001",
    "email": "student001@example.com",
    "real_name": "å­¦ç”Ÿ001",
    "role_id": 2
  }
}
```

### åˆ›å»ºåç»‘å®šå­¦ç”Ÿ

åˆ›å»ºå­¦ç”Ÿç”¨æˆ·åï¼Œæ•™å¸ˆéœ€è¦å°†å­¦ç”Ÿç»‘å®šåˆ°è‡ªå·±çš„ç­çº§ï¼š

```bash
POST /api/teacher/{teacherId}/students
{
  "student_ids": [æ–°åˆ›å»ºçš„å­¦ç”ŸID]
}
```

## ğŸ”‘ æƒé™éªŒè¯è¯´æ˜

### æ•™å¸ˆæƒé™æ£€æŸ¥
- æ‰€æœ‰æ•™å¸ˆç›¸å…³æ¥å£éƒ½ä¼šéªŒè¯ï¼š
  1. ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
  2. ç”¨æˆ·æ˜¯å¦å…·æœ‰æ•™å¸ˆè§’è‰²
  3. æ•™å¸ˆæ˜¯å¦åªèƒ½æ“ä½œè‡ªå·±ç»‘å®šçš„å­¦ç”Ÿ

### å­¦ç”Ÿæ•°æ®è®¿é—®æ§åˆ¶
- æ•™å¸ˆåªèƒ½æŸ¥çœ‹**å·²ç»‘å®š**å­¦ç”Ÿçš„æ•°æ®
- æ•™å¸ˆä¸èƒ½æŸ¥çœ‹å…¶ä»–æ•™å¸ˆçš„å­¦ç”Ÿæ•°æ®
- æ•™å¸ˆä¸èƒ½æŸ¥çœ‹æœªç»‘å®šå­¦ç”Ÿçš„æ•°æ®

## ğŸ“± å‰ç«¯å®ç°å»ºè®®

### 1. æƒé™æ§åˆ¶
```javascript
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºæ•™å¸ˆ
const isTeacher = user.roles.some(role => role.name === 'teacher');

// æ£€æŸ¥æ•™å¸ˆæƒé™
const hasPermission = (permission) => {
  return user.permissions.some(p => p.name === permission);
};
```

### 2. é¡µé¢è®¿é—®æ§åˆ¶
```javascript
// æ•™å¸ˆä¸“ç”¨é¡µé¢
if (!isTeacher) {
  // é‡å®šå‘åˆ°æ— æƒé™é¡µé¢
  router.push('/no-permission');
}
```

### 3. åŠŸèƒ½æŒ‰é’®æ§åˆ¶
```javascript
// æ ¹æ®æƒé™æ˜¾ç¤º/éšè—åŠŸèƒ½
const canCreateStudent = hasPermission('student.create');
const canViewSubmissions = hasPermission('student.submission.read');
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®å®‰å…¨**ï¼šæ•™å¸ˆåªèƒ½è®¿é—®è‡ªå·±ç»‘å®šçš„å­¦ç”Ÿæ•°æ®
2. **æƒé™éªŒè¯**ï¼šæ‰€æœ‰æ¥å£éƒ½æœ‰ä¸¥æ ¼çš„æƒé™éªŒè¯
3. **é”™è¯¯å¤„ç†**ï¼šå‰ç«¯éœ€è¦å¤„ç†æƒé™ä¸è¶³ã€å­¦ç”Ÿæœªç»‘å®šç­‰é”™è¯¯æƒ…å†µ
4. **ç”¨æˆ·ä½“éªŒ**ï¼šå»ºè®®åœ¨ç•Œé¢ä¸Šæ˜ç¡®æ˜¾ç¤ºæ•™å¸ˆçš„æƒé™èŒƒå›´

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰æ¥å£ä½¿ç”¨é—®é¢˜ï¼Œè¯·è”ç³»åç«¯å¼€å‘å›¢é˜Ÿã€‚
